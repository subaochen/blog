#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass ctex-article
\begin_preamble
\input{/home/subaochen/git/writing-common/article-preamble.tex}
\usepackage{smartdiagram}
\end_preamble
\use_default_options true
\begin_modules
coderemarks
tip-inset
note-inset
warning-inset
theorems-bytype
logicalmkup
\end_modules
\maintain_unincluded_children false
\language chinese-simplified
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "FreeSerif"
\font_sans "default" "FreeSans"
\font_typewriter "default" "FreeMono"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts true
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format pdf5
\output_sync 0
\bibtex_command bibtex8
\index_command default
\float_placement tbph
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 3
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style IEEETranS
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\boxbgcolor #c3c3c3
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
断行的效果评价：demerits
\end_layout

\begin_layout Author
宿宝臣<subaochen@126.com>
\end_layout

\begin_layout Standard
在
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://softlab.sdut.edu.cn/blog/subaochen/2017/06/细说badness/
\end_layout

\end_inset

中，我们已经看到，\SpecialChar TeX
使用badness评价断行后伸缩盒子对排版效果的影响，这是评价水平盒子排版效果的主要因子，但不是唯一因子。事实上，实际情况远比badness复
杂，比如人为干预断行，连字符的影响，当前断行方案对段落中下面几行的影响等等，都应该在评估当前行断行效果时考虑进去。因此，\SpecialChar TeX
设置了demerits变量综合评估当前行
的断行效果。本部分内容重点讨论各种情况下对断行的影响，最后给出demerits的计算公式。
\end_layout

\begin_layout Section
\SpecialChar TeX
的断行流程
\end_layout

\begin_layout Standard
考虑到可能使用连字符进行断行，\SpecialChar TeX
断行的基本过程如
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
figurename
\end_layout

\end_inset


\begin_inset CommandInset ref
LatexCommand ref
reference "fig:TeX的断行流程"

\end_inset

所示，即\SpecialChar TeX
首先尝试不使用连字符断行，如果此时获得的badness小于pretolerance的设定阀值，则万事大吉；否则尝试在这一行使用连字符断行，如果此时获得的
badness小于tolerance的设定阀值，断行就此结束；否则在每一行的badness上面叠加一个emergencypenalty（but
 why？），重新尝试...
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset CommandInset include
LatexCommand include
filename "/home/subaochen/git/blog/imgs/latex/tex/tex-hyphen-flow.tex"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
\SpecialChar TeX
的断行流程
\begin_inset CommandInset label
LatexCommand label
name "fig:TeX的断行流程"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
人为干预断行：penalty
\end_layout

\begin_layout Standard
penalty以及后面的各种*penalty，意味着如果在这里断行会遭受惩罚，penalty的值即为罚金！罚金为正则\SpecialChar TeX
倾向于避免在这里断行，罚金为负则\SpecialChar TeX
倾向于在这里
断行。罚金值越高，倾向性越高，罚金的最大值是10000。比如设置
\backslash
penalty=10000，则意味着在这里断行的话会遭受重罚，penalty的值即为罚金，因此\SpecialChar TeX
不会在这里断行。相反，如果设置为
\backslash
penalty=-10000，则意味着在这里断行会“重罚”-10000，其实是鼓励\SpecialChar TeX
在这里断行的意思，\SpecialChar TeX
则一定在这里断行（谁不喜欢这么大的红包呢！）。
\end_layout

\begin_layout Standard
实际上，
\backslash
break的定义即为
\backslash
penalty-10000，
\backslash
nobreak的定义即为
\backslash
penalty10000，
\backslash
allowbreak的定义为
\backslash
penalty0。
\end_layout

\begin_layout Standard
penalty是一种人为的断行干预手段，如果在一行中设置了
\backslash
penalty，显然会影响当前行的断行效果，因此penalty自然应该计入断行效果评估体系中，参见公式。
\end_layout

\begin_layout Section
人为干预断行：linepenalty
\end_layout

\begin_layout Standard
当施加一个linepenalty时，通常情况下无法使用拉伸满足两端对齐的排版要求（拉伸会导致badness很大），因此一般会采用压缩的方式降低badness，因
此使用linepenalty的结果是，\SpecialChar TeX
会尝试用更少的行完成排版，即排版效果更紧凑。例如：
\end_layout

\begin_layout Section
连字符断行：hyphenpanlty/exhyphenpenalty
\end_layout

\begin_layout Standard
对于西文而言，连字符是另外一个考虑的重要因素：如果不使用连字符就能够获得满意的排版效果，这是最理想的情况；但是如果必须通过连字符才能获得较为满意的排版效果，则在
评估排版的综合效果时，需要扣除连字符造成的“阅读影响”，毕竟连字符硬生生的将一个完整的单词斩做两半分列两行，读者需要费脑筋在脑海中将两部分再拼成一个完整的单词。
\end_layout

\begin_layout Section
考虑下两行的断行效果：doublehyphenpenalty
\end_layout

\begin_layout Section
考虑最后三行的断行效果：finalhyphenpenalty
\end_layout

\begin_layout Section
demerits
\end_layout

\end_body
\end_document
